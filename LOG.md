# 2025-03-26

MCP の 2025-03-06 リビジョンの内容を Claude デスクトップ＋ Playwright MCP ＋ FileSystem MCP を使ってまとめた。

## 手順

以下のステップでプロンプトを実施した。

1. サイトマップ作成
2. 構造作成
3. 指示

各手順の詳細は以下の通り。

### 1. サイトマップ作成

実際のプロンプト：

```md
下記のページのサイドバーの「2025-03-26 (Latest)」配下のサイトマップを作成してください。

https://spec.modelcontextprotocol.io/specification/2025-03-26/
```

ポイント：

- 「2025-03-26 (Latest)」に絞る
  - 最初に試したときはポイントを絞らなかったので、前バージョンも含めてサイドバーの全要素についてサイトマップを作成していた。

### 2. 構造作成

実際のプロンプト：

```md
下記のディレクトリ配下にサイトマップのレベル 1 の要素に相当する空のマークダウンファイルを作成して下さい。

`C:\Users\fuchigta\src\github.com\fuchigta\mcp-spec\2025-03-26`

例）key-changes.md、architecture.md、base-protocol.md、server-features.md…
```

ポイント：

- マークダウンの作成単位はなるべく大きくする
  - 最初に似たような方法で調査をした際には全部の要素についてマークダウンを作らせようとした
  - が、Claude Sonnet 3.7 は結構さぼろうとする（メッセージ長を気にしてくれてる？）ので、このファイルは作らないみたいな挙動をしがち
  - 個別のページで要約させるとあまり要約にならない（原文ママみたいになる）のもある

### 3. 指示

実際のプロンプト：

```md
ありがとうございます。

これからあなたには作成したマークダウンに該当するサイトマップのレベル 1 の要素について調査した結果をまとめてもらいます。

1. 私から指示したレベル 1 の要素について、サイトマップの該当する要素および配下の要素のページを確認してください。
2. 確認が終わったら、マークダウンファイルに確認した内容を要約して記入してください。
   1. mermaid の図や、マークダウンの表形式を活用してわかりやすくまとめてください。
   2. サイトマップのレベル 2 以下の要素は見出しとしてください。
   3. 元ページへのリンクを記載してください。

指示はひとつづつ実施します。

最初は「Key Changes」について調査してまとめてください。
```

ポイント：

- マークダウンの作成単位で指示をする
  - サイトマップのレベル 1 単位でマークダウンを作成してもらうが、レベル 2 以下の要素も確認してもらう必要がある
  - まとめて指示すると先に全量確認しようとしたり、作業がぶつ切りになることを懸念して作業単位を分けた
- 指示内容を明確にする
  - mermaid の図を使ってほしい、マークダウンの表形式を使ってほしいのように道具立てをすると従ってくれる
    - （「わかりやすく」は明確でもないけど）

## 次回試すこと

### 1. セッションの分割

3 で順を追ってすべてのレベル 1 要素を指定していくことでまとめ切れた。

しかし、最後の指示のあとに本ファイルを作成してもらおうと思ったが、メッセージ長超過でチャットが継続できなかった。

3 をレベル 1 の要素単位で個別のセッションに分けた方がいいかもしれない（仕上がりがばらけるかもしれないが…）。

### 2. 指示プロンプトの改善

RFC のように元の文書には MUST や SHOULD が含まれる。

今回は特にケアしなかったので、素直に「**必須**」のような形で不自然に要約に組み込まれてしまった。

上記のようなキーワードは括弧付きでそのまま要約に含めるように指示した方がいいかもしれない。

### 3. ワークフロー化

この手順での調査の実績も溜まってきたので、LangChain 等でワークフロー化してもいいかもしれない。
